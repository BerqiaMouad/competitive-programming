/*
                                                                                    
                                                  ████                              
                                                ██▓▓██                              
                                              ▒▒▓▓▒▒██                              
                              ██            ██▒▒▒▒▒▒██                              
                              ██          ▒▒▓▓▒▒▒▒▓▓██                              
                              ██▓▓      ▓▓▓▓▒▒▒▒▒▒████                              
                            ██▒▒██    ██▒▒▒▒▒▒▒▒██████        ██████████            
                            ██▒▒▒▒██  ██▒▒▒▒▒▒▒▒██████  ██████▒▒▒▒▒▒████            
                            ██▒▒▒▒████▒▒▒▒▒▒▒▒██████████▒▒▒▒▒▒▒▒████████            
                            ██▒▒▒▒████▒▒▒▒▒▒▒▒████████▓▓▒▒▒▒▒▒▓▓██████              
                          ▒▒▓▓▒▒▒▒████▒▒▒▒▒▒▓▓██████▓▓▒▒▒▒▓▓▓▓████████              
                          ██▒▒▒▒▒▒████▒▒▒▒████████████▓▓████████████                
                  ▓▓      ██▒▒▒▒▒▒████▒▒████████████████████████████                
                  ██▓▓    ██▒▒▒▒▓▓████████████████▓▓████████████████▓▓              
                  ██▓▓▓▓▓▓▓▓▒▒▒▒████████████▓▓▒▒▓▓████████████████████▓▓▓▓          
                  ██▒▒▓▓██▒▒▒▒▒▒██████████▒▒▒▒▒▒██████████████████████████▒▒▓▓      
                  ██▒▒▒▒▒▒▒▒▒▒▒▒██████████▒▒██████████████▓▓▓▓██████████████        
                    ██▒▒▒▒██▒▒▒▒████████▓▓██████████████▓▓████████████████          
                    ██▒▒▒▒████▒▒████████████████████████████████████████            
                      ██▒▒████████▓▓██████████████████████████████████              
                  ▓▓▓▓████▓▓████▒▒░░██████████▒▒██████████████████████▓▓            
                    ████████████▒▒░░░░██████▓▓▒▒▒▒██████▒▒████████████              
                      ████████████░░░░  ▒▒██▓▓▒▒▒▒████▒▒▒▒██████████                
                        ██████████░░░░░░░░░░░░▒▒▒▒▒▒▒▒▒▒██████████                  
                        ██████████░░░░░░░░░░░░░░▒▒▒▒▒▒▒▒████████████                
                          ████████▒▒░░░░░░░░░░░░  ▒▒▒▒██▒▒████████                  
                          ██░░████▓▓▒▒    ░░░░░░  ▒▒▓▓██▒▒▓▓████░░                  
                          ██░░▒▒██▒▒▒▒▓▓▓▓▓▓▒▒▒▒▓▓▓▓████▒▒▒▒██                      
                          ██░░▒▒░░▒▒  ████▒▒▒▒▒▒▓▓██████▒▒▒▒██                      
                            ██░░    ▒▒████▒▒░░░░░░██▓▓██▒▒▒▒██                      
                              ▓▓▒▒░░░░░░░░░░░░░░░░████▒▒▒▒▓▓████▓▓                  
                                ██░░░░░░░░░░░░░░▒▒▒▒▒▒████  ░░░░░░██                
                              ▒▒▒▒▓▓░░░░░░░░░░░░▒▒▒▒▓▓░░░░░░░░░░  ▒▒▒▒              
                              ██▒▒▒▒▓▓▒▒░░  ▓▓▓▓▓▓▒▒██░░░░░░░░░░░░▒▒▒▒▓▓            
                              ██▒▒▒▒░░▓▓▓▓▒▒░░░░▒▒▓▓░░░░░░░░░░░░▒▒▒▒▒▒██            
              ▓▓██▓▓          ██▒▒▒▒  ░░▓▓▓▓▓▓▓▓▓▓██░░░░░░░░░░▒▒▒▒▒▒▒▒▒▒▓▓          
            ▓▓▒▒▒▒▒▒▓▓          ▓▓▒▒░░░░██▓▓▓▓▓▓████  ░░░░░░▒▒▒▒▒▒▒▒▒▒▒▒██          
    ▓▓▓▓▓▓▓▓██▓▓▓▓▒▒▒▒▓▓          ██    ██▓▓▒▒▓▓▓▓██▒▒▒▒░░░░░░▒▒▒▒▒▒▒▒▒▒██          
    ██░░░░░░░░██▓▓▒▒▒▒██▓▓▓▓▓▓▓▓▓▓██░░  ██▓▓▒▒▒▒▓▓██▒▒░░░░░░░░▒▒▒▒▓▓▓▓▓▓▒▒▓▓        
      ▓▓▓▓▓▓░░░░░░░░░░░░██▒▒▒▒▒▒▒▒██  ░░░░██▒▒▒▒██▒▒░░░░░░░░░░▒▒▒▒▓▓▓▓██▒▒▒▒▓▓      
░░██▓▓████▒▒▒▒  ░░  ░░░░░░██▒▒▒▒▒▒▒▒▓▓  ░░░░▒▒▒▒██░░  ░░░░░░░░▒▒▓▓▓▓▓▓▓▓▒▒▒▒██      
░░██  ░░░░░░░░░░░░░░░░░░░░▒▒████▒▒▒▒██  ░░░░  ██  ░░░░░░░░░░░░██▓▓▓▓▓▓▒▒▒▒▒▒██      
    ▓▓▓▓▓▓▓▓░░░░░░░░░░░░░░░░░░░░██████▓▓▓▓▓▓████░░░░░░░░░░░░░░██▓▓▓▓▒▒▒▒▒▒▒▒██▓▓    
        ██▓▓▒▒▒▒  ░░░░▒▒▒▒░░░░░░░░░░░░░░░░░░▒▒▒▒░░░░░░  ░░░░▒▒▓▓████▒▒▒▒▒▒▒▒██▒▒▓▓  
          ██▒▒▒▒░░░░░░▒▒▒▒▒▒░░░░░░░░░░░░░░░░░░▒▒  ░░░░░░▒▒▒▒▒▒████▒▒██▒▒▒▒▒▒██▒▒██  
            ██████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░▒▒▒▒▒▒██▒▒▒▒▒▒██████▒▒▒▒▒▒██
                ░░  ░░░░      ████░░░░░░░░░░░░░░░░░░░░░░▒▒▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██
          ░░  ░░░░░░░░░░░░░░░░    ████░░░░  ░░░░░░░░░░░░▒▒▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██
            ░░░░░░░░░░░░░░░░░░░░░░  ░░██▒▒░░░░░░░░░░░░░░▒▒██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░  
              ░░░░░░░░░░░░░░░░░░░░░░░░██████▒▒▒▒▒▒▒▒░░░░██▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒      
                  ░░░░░░░░░░░░░░░░░░██  ░░  ██████▒▒░░░░██▒▒    ▒▒▒▒▒▒▒▒▒▒          
                        ░░░░░░░░░░░░██    ░░░░    ██████▒▒▒▒▒▒▒▒                    
                            ░░░░▓▓▓▓██            ░░░░░░▒▒▒▒▒▒░░            
*/


#include <bits/stdc++.h>
using namespace std;

typedef long long ll;
#define all(c) c.begin(), c.end()


int main(){
	ios_base::sync_with_stdio(0);
	cin.tie(0);

	#ifndef ONLINE_JUDGE

	freopen("in.txt", "r", stdin);
	freopen("out.txt", "w", stdout);

	#endif

	ll t; cin >> t;
	while(t--){
		ll n, m, k ; cin >> n >> m >> k;
		vector<ll> a(m);
		for(auto &it: a)
			cin >> it;

		sort(all(a));
		if(k == 1 && n > 1 && m == 1){
			cout << "NO\n";
			continue;
		}
		if(k > m){
			cout << "NO\n";
			continue;
		}
		ll remove = a[0];
		for(int i = 0; i < m; i++){
			a[i] -= remove;
			remove += a[i];
		}
		bool ok = true;
		for(int i = 0; i < m; i++){
			if(a[i] > 0){
				ok = false;
				break;
			}
		}
		if(ok)
			cout << "YES\n";
		else 
			cout << "NO\n";
	}

	return 0;
}